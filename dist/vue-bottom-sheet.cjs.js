"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),$=require("vue-router"),I=(k,p)=>{const l=k.__vccOpts||k;for(const[u,w]of p)l[u]=w;return l},U={class:"lg:hidden"},A=["href"],G=["href","onClick"],J=5,K={__name:"BottomSheet",props:{modelValue:Boolean,middleY:{type:Number,default:50},fullY:{type:Number,default:5},quickLinks:{type:Object}},emits:["update:modelValue","state-change","handle-click"],setup(k,{emit:p}){const l=k,u=p;$.useRoute();const w=e.ref(!1),_=e.ref(""),z=e.ref(null),R=e.ref(null),v=e.ref(null),x=e.ref(null),f=e.ref(!1),g=e.ref(!1),L=e.ref(0),b=e.ref(100),a=e.ref(100),Y=e.ref(0),M=e.ref(0),o=e.ref(100);e.watch(v,async t=>{t&&(await e.nextTick(),Y.value=t.offsetHeight)},{immediate:!0});const D=e.computed(()=>{const t=window.innerHeight;if(!t||Y.value<=0)return-1;const n=Y.value/t*100,s=(M.value||0)/t*100;return n+s});e.watch(D,t=>{if(t>=0){const n=Math.max(0,100-t);if(Math.abs(n-o.value)>.1){const s=o.value;o.value=n,Math.abs(a.value-s)<1&&(a.value=o.value),Math.abs(b.value-s)<1&&!g.value&&(b.value=o.value)}}}),e.computed(()=>[o.value,l.middleY,l.fullY].sort((t,n)=>n-t));const F=e.computed(()=>({top:`${a.value}vh`,position:"fixed",left:"0",right:"0",bottom:"0",transition:f.value?"none":"top 0.3s ease-out",maxHeight:`calc(100vh - ${l.fullY}vh)`})),B=e.computed(()=>o.value<100&&Math.abs(a.value-o.value)<1);e.watch(B,async t=>{if(t&&(await e.nextTick(),x.value)){const n=x.value.offsetHeight;n>0&&M.value!==n&&(M.value=n)}});const j=t=>{v.value&&!v.value.contains(t.target)||(t.preventDefault(),t.stopPropagation(),g.value=!0,f.value=!1,L.value=t.clientY,b.value=a.value,window.addEventListener("pointermove",V,{passive:!1}),window.addEventListener("pointerup",y),window.addEventListener("pointerleave",y))},V=t=>{if(!g.value)return;const n=t.clientY,s=Math.abs(n-L.value);if(!f.value&&s>J&&(f.value=!0,document.body.style.cursor="grabbing",document.body.style.userSelect="none"),f.value){t.preventDefault();const i=n-L.value,m=window.innerHeight;if(m===0)return;const r=i/m*100;let c=b.value+r;const h=o.value<100?o.value:l.middleY;c=Math.max(l.fullY,Math.min(h,c)),a.value=c}},y=t=>{if(!g.value)return;const n=1,s=Math.abs(b.value-o.value)<n;if(f.value){f.value=!1,document.body.style.cursor="",document.body.style.userSelect="";const i=a.value,m=b.value,r=o.value,c=l.middleY,h=l.fullY;let d;const P=i<m;if(s&&P)if(i>c-n)d=c;else{const N=Math.abs(i-c);d=Math.abs(i-h)<N?h:c}else d=[r,c,h].reduce((T,H)=>Math.abs(H-i)<Math.abs(T-i)?H:T);a.value=d;let C="peek",E=!1;Math.abs(d-c)<n?(C="middle",E=!0):Math.abs(d-h)<n&&(C="full",E=!0),l.modelValue!==E&&u("update:modelValue",E),u("state-change",C,d)}else s&&(u("handle-click"),a.value=l.middleY,l.modelValue||u("update:modelValue",!0),u("state-change","middle",l.middleY));g.value=!1,window.removeEventListener("pointermove",V),window.removeEventListener("pointerup",y),window.removeEventListener("pointerleave",y)},O=()=>{a.value!==o.value&&(a.value=o.value,l.modelValue&&u("update:modelValue",!1),u("state-change","peek",o.value))};e.onMounted(async()=>{_.value=navigator.userAgent.toLowerCase(),w.value=/ipad/.test(_.value)&&/safari/.test(_.value)&&!/chrome/.test(_.value),v.value&&(await e.nextTick(),Y.value=v.value.offsetHeight),setTimeout(()=>{const t=o.value;l.modelValue?(Math.abs(a.value-t)<1||a.value>=100)&&(a.value=l.middleY,u("state-change","middle",l.middleY)):Math.abs(a.value-t)>.1&&(a.value=t,u("state-change","peek",t))},0),window.addEventListener("resize",S)}),e.onUnmounted(()=>{window.removeEventListener("pointermove",V),window.removeEventListener("pointerup",y),window.removeEventListener("pointerleave",y),window.removeEventListener("resize",S),document.body.style.cursor="",document.body.style.userSelect=""});const S=async()=>{v.value&&(await e.nextTick(),Y.value=v.value.offsetHeight),B.value&&x.value&&(await e.nextTick(),M.value=x.value.offsetHeight)};return e.watch(()=>l.modelValue,t=>{if(f.value||g.value)return;const n=a.value,s=1,i=Math.abs(n-l.middleY)<s||Math.abs(n-l.fullY)<s,m=Math.abs(n-o.value)<s;t&&!i?(a.value=l.middleY,u("state-change","middle",l.middleY)):!t&&!m&&(a.value=o.value,u("state-change","peek",o.value))}),(t,n)=>{const s=e.resolveComponent("router-link");return e.openBlock(),e.createElementBlock("div",U,[e.createVNode(e.Transition,{name:"fade"},{default:e.withCtx(()=>[B.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:"fixed inset-0 z-40 bg-gray-900/60 pointer-events-auto",onClick:O}))]),_:1}),e.createElementVNode("div",{ref_key:"sheetRef",ref:z,class:"fixed bottom-0 left-0 right-0 bg-white rounded-t-xl shadow-2xl flex flex-col pointer-events-auto overflow-hidden touch-pan-y z-50",style:e.normalizeStyle(F.value)},[e.createElementVNode("div",{ref_key:"handleRef",ref:v,class:"py-3 flex justify-center items-center cursor-grab active:cursor-grabbing touch-none flex-shrink-0",onPointerdown:j},n[0]||(n[0]=[e.createElementVNode("div",{class:"w-10 h-1.5 bg-gray-300 rounded-full pointer-events-none"},null,-1)]),544),B.value?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"quickLinksRef",ref:x,class:e.normalizeClass(["px-4","pt-3",l.quickLinks?"":" p-12 ",w.value&&l.quickLinks?" pb-24 border-t border-gray-200 ":"",!w.value&&l.quickLinks?" pb-14 border-t border-gray-200 ":""])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.quickLinks,(i,m)=>(e.openBlock(),e.createElementBlock("div",{key:`mobile-sheet-section-${m}`,class:"flex justify-around"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.items,(r,c)=>(e.openBlock(),e.createElementBlock("div",null,[r.href?(e.openBlock(),e.createElementBlock("a",{key:0,href:r.href,class:e.normalizeClass([r.current?"bg-gray-100/60 text-urbis-blue":"text-gray-700 hover:bg-gray-50 hover:text-urbis-blue","group flex gap-x-3 rounded-md p-2 text-sm/6 font-semibold"])},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(r.icon),e.mergeProps({ref_for:!0},r.iconProps,{class:["size-6 shrink-0",r.iconProps?"":r.current?"text-urbis-blue":"text-gray-400 group-hover:text-urbis-blue"],"aria-hidden":"true"}),null,16,["class"]))],10,A)):r.to?(e.openBlock(),e.createBlock(s,{key:1,to:r.to,custom:""},{default:e.withCtx(({href:h,navigate:d,isActive:P})=>[e.createElementVNode("a",{href:h,onClick:e.withModifiers(()=>{d()},["prevent"]),class:e.normalizeClass([P?"bg-gray-100/60 text-urbis-blue":"text-gray-700 hover:bg-gray-50 hover:text-urbis-blue","group flex gap-x-3 rounded-md p-2 text-sm/6 font-semibold"])},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(r.icon),e.mergeProps({ref_for:!0},r.iconProps,{class:["size-6 shrink-0",r.iconProps?"":P?"text-urbis-blue":"text-gray-400 group-hover:text-urbis-blue"],"aria-hidden":"true"}),null,16,["class"]))],10,G)]),_:2},1032,["to"])):e.createCommentVNode("",!0)]))),256))]))),128))],2)):e.createCommentVNode("",!0),e.createVNode(e.Transition,{name:"fade"},{default:e.withCtx(()=>[B.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"contentRef",ref:R,class:"flex-1 overflow-y-auto px-4 pb-4 min-h-[0]"},[e.renderSlot(t.$slots,"default",{},void 0,!0)],512))]),_:3})],4)])}}},q=I(K,[["__scopeId","data-v-de3f53df"]]),Q={install:(k,p)=>{const l=(p==null?void 0:p.componentName)||"BottomSheet";k.component(l,q)}};exports.BottomSheet=q;exports.default=Q;
