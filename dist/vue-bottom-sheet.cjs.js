"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),U=require("vue-router"),A=(y,k)=>{const l=y.__vccOpts||y;for(const[u,P]of k)l[u]=P;return l},G={class:"lg:hidden"},K=["href"],J=["href","onClick"],Q=5,H="--bottom-sheet-peek-height",W={__name:"BottomSheet",props:{modelValue:Boolean,middleY:{type:Number,default:50},fullY:{type:Number,default:5},quickLinks:{type:Object}},emits:["update:modelValue","state-change","handle-click"],setup(y,{emit:k}){const l=y,u=k;U.useRoute();const P=e.ref(!1),E=e.ref(""),z=e.ref(null),D=e.ref(null),m=e.ref(null),_=e.ref(null),h=e.ref(!1),w=e.ref(!1),L=e.ref(0),x=e.ref(100),n=e.ref(100),g=e.ref(0),c=e.ref(0),r=e.ref(100),F=e.computed(()=>g.value>0?g.value+c.value:0);e.watch(m,async t=>{t&&(await e.nextTick(),g.value=t.offsetHeight)});const $=e.computed(()=>{const t=window.innerHeight;if(!t||g.value<=0)return-1;const a=g.value/t*100,i=(c.value||0)/t*100;return a+i});e.watch($,t=>{if(t>=0){const a=Math.max(0,100-t);if(Math.abs(a-r.value)>.1){const i=r.value;r.value=a,Math.abs(n.value-i)<1&&(n.value=r.value),Math.abs(x.value-i)<1&&!w.value&&(x.value=r.value)}}}),e.computed(()=>[r.value,l.middleY,l.fullY].sort((t,a)=>a-t));const j=e.computed(()=>({top:`${n.value}vh`,position:"fixed",left:"0",right:"0",bottom:"0",transition:h.value?"none":"top 0.3s ease-out",maxHeight:`calc(100vh - ${l.fullY}vh)`})),b=e.computed(()=>r.value<100&&Math.abs(n.value-r.value)<1);e.watch(b,async t=>{if(t)if(await e.nextTick(),_.value){const a=_.value.offsetHeight;c.value!==a&&(c.value=a)}else c.value!==0&&(c.value=0);else c.value!==0&&(c.value=0)},{immediate:!0}),e.watch([F,b],([t,a])=>{a&&t>0?document.documentElement.style.setProperty(H,`${t}px`):document.documentElement.style.setProperty(H,"0px")},{immediate:!0});const O=t=>{m.value&&!m.value.contains(t.target)||(t.preventDefault(),t.stopPropagation(),w.value=!0,h.value=!1,L.value=t.clientY,x.value=n.value,window.addEventListener("pointermove",C,{passive:!1}),window.addEventListener("pointerup",Y),window.addEventListener("pointerleave",Y))},C=t=>{if(!w.value)return;const a=t.clientY,i=Math.abs(a-L.value);if(!h.value&&i>Q&&(h.value=!0,document.body.style.cursor="grabbing",document.body.style.userSelect="none"),h.value){t.preventDefault();const s=a-L.value,f=window.innerHeight;if(f===0)return;const o=s/f*100;let d=x.value+o;const p=r.value<100?r.value:l.middleY;d=Math.max(l.fullY,Math.min(p,d)),n.value=d}},Y=t=>{if(!w.value)return;const a=1,i=Math.abs(x.value-r.value)<a;if(h.value){h.value=!1,document.body.style.cursor="",document.body.style.userSelect="";const s=n.value,f=x.value,o=r.value,d=l.middleY,p=l.fullY;let v;const M=s<f;if(i&&M)if(s>d-a)v=d;else{const B=Math.abs(s-d);v=Math.abs(s-p)<B?p:d}else{const B=[d,p];o<100&&B.push(o),B.length===0?v=f:v=B.reduce((T,q)=>Math.abs(q-s)<Math.abs(T-s)?q:T)}n.value=v;let S="peek",V=!1;Math.abs(v-d)<a?(S="middle",V=!0):Math.abs(v-p)<a&&(S="full",V=!0),l.modelValue!==V&&u("update:modelValue",V),u("state-change",S,v)}else i&&(u("handle-click"),n.value=l.middleY,l.modelValue||u("update:modelValue",!0),u("state-change","middle",l.middleY));w.value=!1,window.removeEventListener("pointermove",C),window.removeEventListener("pointerup",Y),window.removeEventListener("pointerleave",Y)},I=()=>{n.value!==r.value&&r.value<100&&(n.value=r.value,l.modelValue&&u("update:modelValue",!1),u("state-change","peek",r.value))};e.onMounted(async()=>{E.value=navigator.userAgent.toLowerCase(),P.value=/ipad/.test(E.value)&&/safari/.test(E.value)&&!/chrome/.test(E.value),m.value&&(await e.nextTick(),g.value=m.value.offsetHeight),setTimeout(()=>{const t=r.value;l.modelValue?(Math.abs(n.value-t)<1||n.value>=100)&&(n.value=l.middleY,u("state-change","middle",l.middleY)):t<100&&Math.abs(n.value-t)>.1?(n.value=t,u("state-change","peek",t)):t>=100&&n.value<100&&(n.value=100,u("state-change","hidden",100))},0),window.addEventListener("resize",N)}),e.onUnmounted(()=>{window.removeEventListener("pointermove",C),window.removeEventListener("pointerup",Y),window.removeEventListener("pointerleave",Y),window.removeEventListener("resize",N),document.body.style.cursor="",document.body.style.userSelect="",document.documentElement.style.removeProperty(H)});const N=async()=>{if(m.value&&(await e.nextTick(),g.value=m.value.offsetHeight),b.value&&_.value){await e.nextTick();const t=_.value.offsetHeight;c.value!==t&&(c.value=t)}else b.value||c.value!==0&&(c.value=0)};return e.watch(()=>l.modelValue,t=>{if(h.value||w.value)return;const a=n.value,i=1,s=r.value,f=Math.abs(a-l.middleY)<i||Math.abs(a-l.fullY)<i,o=s<100&&Math.abs(a-s)<i;t&&!f?(n.value=l.middleY,u("state-change","middle",l.middleY)):!t&&!o&&(s<100?(n.value=s,u("state-change","peek",s)):(n.value=100,u("state-change","hidden",100)))}),(t,a)=>{const i=e.resolveComponent("router-link");return e.openBlock(),e.createElementBlock("div",G,[e.createVNode(e.Transition,{name:"fade"},{default:e.withCtx(()=>[b.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:"fixed inset-0 z-40 bg-gray-900/60 pointer-events-auto",onClick:I}))]),_:1}),e.createElementVNode("div",{ref_key:"sheetRef",ref:z,class:"fixed bottom-0 left-0 right-0 bg-white rounded-t-xl shadow-2xl flex flex-col pointer-events-auto overflow-hidden touch-pan-y z-50",style:e.normalizeStyle(j.value)},[e.createElementVNode("div",{ref_key:"handleRef",ref:m,class:"py-3 flex justify-center items-center cursor-grab active:cursor-grabbing touch-none flex-shrink-0",onPointerdown:O},a[0]||(a[0]=[e.createElementVNode("div",{class:"w-10 h-1.5 bg-gray-300 rounded-full pointer-events-none"},null,-1)]),544),b.value?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"quickLinksRef",ref:_,class:e.normalizeClass(["px-4","pt-3",l.quickLinks?"":" p-12 ",P.value&&l.quickLinks?" pb-24 border-t border-gray-200 ":"",!P.value&&l.quickLinks?" pb-14 border-t border-gray-200 ":""])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.quickLinks,(s,f)=>(e.openBlock(),e.createElementBlock("div",{key:`mobile-sheet-section-${f}`,class:"flex justify-around"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.items,(o,d)=>(e.openBlock(),e.createElementBlock("div",{key:d},[o.href?(e.openBlock(),e.createElementBlock("a",{key:0,href:o.href,class:e.normalizeClass([o.current?"bg-gray-100/60 text-urbis-blue":"text-gray-700 hover:bg-gray-50 hover:text-urbis-blue","group flex gap-x-3 rounded-md p-2 text-sm/6 font-semibold"])},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(o.icon),e.mergeProps({ref_for:!0},o.iconProps,{class:["size-6 shrink-0",o.iconProps?"":o.current?"text-urbis-blue":"text-gray-400 group-hover:text-urbis-blue"],"aria-hidden":"true"}),null,16,["class"]))],10,K)):o.to?(e.openBlock(),e.createBlock(i,{key:1,to:o.to,custom:""},{default:e.withCtx(({href:p,navigate:v,isActive:M})=>[e.createElementVNode("a",{href:p,onClick:e.withModifiers(()=>{v()},["prevent"]),class:e.normalizeClass([M?"bg-gray-100/60 text-urbis-blue":"text-gray-700 hover:bg-gray-50 hover:text-urbis-blue","group flex gap-x-3 rounded-md p-2 text-sm/6 font-semibold"])},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(o.icon),e.mergeProps({ref_for:!0},o.iconProps,{class:["size-6 shrink-0",o.iconProps?"":M?"text-urbis-blue":"text-gray-400 group-hover:text-urbis-blue"],"aria-hidden":"true"}),null,16,["class"]))],10,J)]),_:2},1032,["to"])):e.createCommentVNode("",!0)]))),128))]))),128))],2)):e.createCommentVNode("",!0),e.createVNode(e.Transition,{name:"fade"},{default:e.withCtx(()=>[b.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"contentRef",ref:D,class:"flex-1 overflow-y-auto px-4 pb-4 min-h-[0]"},[e.renderSlot(t.$slots,"default",{},void 0,!0)],512))]),_:3})],4)])}}},R=A(W,[["__scopeId","data-v-cea64601"]]),X={install:(y,k)=>{const l=(k==null?void 0:k.componentName)||"BottomSheet";y.component(l,R)}};exports.BottomSheet=R;exports.default=X;
